#!/bin/bash

#@ variables
SUFFIX="@tpschool.org"
SRCUSER="ablock"
DESTUSER="mharlan"

#@ arrays
FILEIDS=( '' '' )

#@ functions
change_file_owner() {
    echo "${FILEIDS[@]}" | \
	parallel --will-cite \
		 gam user "$SRCUSER$SUFFIX" add drivefileacl {} \
		 user "$DESTUSER$SUFFIX" owner
}

create_transfer() {
    transfer_apps=( 'gdrive' 'plus' 'calendar' )

    echo "${transfer_apps[@]}" | parallel --will-cite <<EOF
if [[ {} = gdrive ]]; then
gam create datatransfer "$SRCUSER$SUFFIX" {} archive.user@tpschool.org privacy_level shared,private
else
gam create datatransfer "$SRCUSER$SUFFIX" {} archive.user@tpschool.org
fi					      
EOF
}
#@ main

# change ownership to another account
change_file_owner

# begin EVERYTHING transfer
create_transfer

# change ownership back to original owner
SRCUSER="mharlan"
DESTUSER="ablock"

change_file_owner
